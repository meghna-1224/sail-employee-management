{% extends "accounts/base.html" %}
{% block title %}My Attendance{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2>My Attendance</h2>

  {% if record %}
    <p><strong>Today:</strong></p>
    <ul>
      <li>
        Punch In: 
        {% if record.punch_in %}
          {{ record.punch_in|time:"H:i" }}
        {% else %}
          -
        {% endif %}
      </li>
      <li>
        Punch Out: 
        {% if record.punch_out %}
          {{ record.punch_out|time:"H:i" }}
        {% else %}
          -
        {% endif %}
      </li>
    </ul>
  {% else %}
    <p>You have not punched in today.</p>
  {% endif %}

  <form method="post">
    {% csrf_token %}
    {% if not record %}
      <button type="submit" name="action" value="punch_in" class="btn btn-success">Punch In</button>
    {% elif record and not record.punch_out %}
      <button type="submit" name="action" value="punch_out" class="btn btn-danger">Punch Out</button>
    {% else %}
      <span class="text-success">You have completed today's attendance.</span>
    {% endif %}
  </form>

  <hr>

  <h4>Recent Records</h4>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>Punch In</th>
        <th>Punch Out</th>
        <th>Shift</th>
      </tr>
    </thead>
    <tbody>
      {% for rec in recent_records %}
      <tr>
        <td>{{ rec.date }}</td>
        <td>
          {% if rec.punch_in %}
            {{ rec.punch_in|time:"H:i" }}
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          {% if rec.punch_out %}
            {{ rec.punch_out|time:"H:i" }}
          {% else %}
            -
          {% endif %}
        </td>
        <td>{{ rec.shift }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No records found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
